@model PedagogyWorld.Models.RegisterModel
@{
    ViewBag.Title = "Register";
}

<hgroup class="title">
    <h1>@ViewBag.Title.</h1>
    <h2>Create a new account.</h2>
</hgroup>

@using (Html.BeginForm()) {
    @Html.AntiForgeryToken()
    @Html.ValidationSummary()

    <fieldset>
        <legend>Registration Form</legend>
        <ol>
            <li>
                @Html.LabelFor(m => m.UserName)
                @Html.TextBoxFor(m => m.UserName)
            </li>
            <li>
                @Html.LabelFor(m => m.Password)
                @Html.PasswordFor(m => m.Password)
            </li>
           <li>
              @Html.LabelFor(m => m.ConfirmPassword)
              @Html.PasswordFor(m => m.ConfirmPassword)
           </li>

           <li>
              @Html.LabelFor(m => m.Email)
              @Html.TextBoxFor(m => m.Email)
           @*</li>*@

           <li>
              @Html.LabelFor(m => m.State)
              @Html.DropDownListFor(m => m.State, new SelectList(ViewBag.States, "Id", "ShortForm"), new { id = "state" })
           </li>

           <li>
              @Html.LabelFor(m => m.District)
              @Html.DropDownListFor(m => m.District, Enumerable.Empty<SelectListItem>(), "-- Loading Districts --", new { id = "District" })
           </li>

           <li>
              @Html.LabelFor(m => m.School)
              @Html.DropDownListFor(m => m.School, Enumerable.Empty<SelectListItem>(), "-- Loading Schools --", new { id = "School" })
           </li>
        </ol>
        <input type="submit" value="Register" />
    </fieldset>
}

@section Scripts {

    @Scripts.Render("~/bundles/jqueryval")

   <script type="text/javascript">
      
      $('#state').change(function () {
         $.getJSON('/Account/UpdateDistrictJSon?selectedState=' + $("#state option:selected").text(), function (result) {
            var ddl = $('#District');
            ddl.empty();
            $(result).each(function () {
               $(document.createElement('option'))
                  .attr('value', this)
                  .text(this)
                  .appendTo(ddl);
            });
         });
      }).change();
      
      $('#District').change(function () {
         $.getJSON('/Account/UpdateSchoolJSon?selectedDistrict=' + $("#District option:selected").text(), function (result) {
            var ddl = $('#School');
            ddl.empty();
            $(result).each(function () {
               $(document.createElement('option'))
                  .attr('value', this)
                  .text(this)
                  .appendTo(ddl);
            });
         });
      }).change();      

   </script>
}


